import React, { useState } from 'react';
import { Settings, Target, Crosshair, Sliders } from 'lucide-react';

export default function AuxilioFF() {
  const [activeTab, setActiveTab] = useState('funcoes');
  const [config, setConfig] = useState({
    aimBot: false,
    noRecoil: false,
    melhorarMira: false,
    precisao: 0,
    sensibilidade: 50,
    calibracaoX: 0,
    calibracaoY: 0,
    velocidadeMira: 50
  });
  const [loading, setLoading] = useState(false);
  const [status, setStatus] = useState('');

  const handleCheckbox = (key) => {
    setConfig(prev => ({ ...prev, [key]: !prev[key] }));
  };

  const handleSlider = (key, value) => {
    setConfig(prev => ({ ...prev, [key]: parseInt(value) }));
  };

  const aplicarConfiguracoes = async () => {
    setLoading(true);
    setStatus('Aplicando configurações...');
    
    try {
      // Simulação de chamada à API Netlify
      const response = await fetch('/.netlify/functions/apply-config', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({
          config: config,
          package: 'com.dts.freefireth',
          version: '1.94.8',
          timestamp: Date.now()
        })
      });
      
      if (response.ok) {
        setStatus('✓ Configurações aplicadas com sucesso!');
        setTimeout(() => setStatus(''), 3000);
      } else {
        setStatus('✗ Erro ao aplicar configurações');
      }
    } catch (error) {
      setStatus('✗ Erro de conexão');
    } finally {
      setLoading(false);
    }
  };

  const resetarCalibacao = () => {
    setConfig(prev => ({
      ...prev,
      calibracaoX: 0,
      calibracaoY: 0,
      velocidadeMira: 50
    }));
    setStatus('Calibração resetada');
    setTimeout(() => setStatus(''), 2000);
  };

  return (
    <div className="min-h-screen bg-gradient-to-br from-gray-900 via-red-900 to-black p-4 flex items-center justify-center">
      <div className="absolute inset-0 overflow-hidden pointer-events-none">
        {[...Array(30)].map((_, i) => (
          <div
            key={i}
            className="absolute bg-red-500 rounded-full opacity-20"
            style={{
              width: Math.random() * 3 + 1 + 'px',
              height: Math.random() * 3 + 1 + 'px',
              top: Math.random() * 100 + '%',
              left: Math.random() * 100 + '%',
              animation: `twinkle ${Math.random() * 3 + 2}s infinite`
            }}
          />
        ))}
      </div>

      <style>{`
        @keyframes twinkle {
          0%, 100% { opacity: 0.2; }
          50% { opacity: 0.8; }
        }
      `}</style>

      <div className="w-full max-w-md bg-black/80 backdrop-blur-sm rounded-2xl shadow-2xl border-2 border-red-600 overflow-hidden relative z-10">
        <div className="bg-gradient-to-r from-red-600 to-red-800 p-4 text-center">
          <h1 className="text-2xl font-bold text-white flex items-center justify-center gap-2">
            <Target className="w-6 h-6" />
            AUXILIO OPTIMIZER
          </h1>
        </div>

        <div className="flex border-b border-red-900">
          <button
            onClick={() => setActiveTab('funcoes')}
            className={`flex-1 py-3 font-semibold transition-colors ${
              activeTab === 'funcoes'
                ? 'bg-red-600 text-white'
                : 'bg-gray-800 text-gray-400 hover:bg-gray-700'
            }`}
          >
            Funções
          </button>
          <button
            onClick={() => setActiveTab('calibracao')}
            className={`flex-1 py-3 font-semibold transition-colors ${
              activeTab === 'calibracao'
                ? 'bg-red-600 text-white'
                : 'bg-gray-800 text-gray-400 hover:bg-gray-700'
            }`}
          >
            Calibração
          </button>
          <button
            onClick={() => setActiveTab('info')}
            className={`flex-1 py-3 font-semibold transition-colors ${
              activeTab === 'info'
                ? 'bg-red-600 text-white'
                : 'bg-gray-800 text-gray-400 hover:bg-gray-700'
            }`}
          >
            Info
          </button>
        </div>

        <div className="p-6 space-y-4">
          {activeTab === 'funcoes' && (
            <>
              <label className="flex items-center gap-3 text-white cursor-pointer hover:bg-red-900/20 p-2 rounded">
                <input
                  type="checkbox"
                  checked={config.aimBot}
                  onChange={() => handleCheckbox('aimBot')}
                  className="w-5 h-5 accent-red-600"
                />
                <span className="text-lg">Máximo de Precisão</span>
              </label>

              <label className="flex items-center gap-3 text-white cursor-pointer hover:bg-red-900/20 p-2 rounded">
                <input
                  type="checkbox"
                  checked={config.noRecoil}
                  onChange={() => handleCheckbox('noRecoil')}
                  className="w-5 h-5 accent-red-600"
                />
                <span className="text-lg">Norecoil</span>
              </label>

              <label className="flex items-center gap-3 text-white cursor-pointer hover:bg-red-900/20 p-2 rounded">
                <input
                  type="checkbox"
                  checked={config.melhorarMira}
                  onChange={() => handleCheckbox('melhorarMira')}
                  className="w-5 h-5 accent-red-600"
                />
                <span className="text-lg">Melhorar Mira</span>
              </label>

              <div className="pt-4">
                <label className="text-white text-lg block mb-2">
                  Precisão: {config.precisao}
                </label>
                <input
                  type="range"
                  min="0"
                  max="100"
                  value={config.precisao}
                  onChange={(e) => handleSlider('precisao', e.target.value)}
                  className="w-full h-2 bg-gray-700 rounded-lg appearance-none cursor-pointer accent-red-600"
                />
              </div>

              <select
                className="w-full bg-gray-800 text-white p-3 rounded-lg border border-red-600 focus:outline-none focus:ring-2 focus:ring-red-500"
                defaultValue="cabeca"
              >
                <option value="cabeca">Auxilio Cabeça</option>
                <option value="peito">Auxilio Peito</option>
                <option value="corpo">Auxilio Corpo</option>
              </select>

              <button
                onClick={aplicarConfiguracoes}
                disabled={loading}
                className="w-full bg-gradient-to-r from-red-600 to-red-700 hover:from-red-700 hover:to-red-800 text-white font-bold py-4 rounded-lg transition-all transform hover:scale-105 disabled:opacity-50 disabled:cursor-not-allowed shadow-lg"
              >
                {loading ? 'Aplicando...' : 'Aplicar Configurações'}
              </button>
            </>
          )}

          {activeTab === 'calibracao' && (
            <>
              <div className="bg-red-900/20 p-4 rounded-lg border border-red-600">
                <div className="flex items-center gap-2 text-red-400 mb-3">
                  <Sliders className="w-5 h-5" />
                  <span className="font-semibold">Calibração de Mira</span>
                </div>

                <div className="space-y-4">
                  <div>
                    <label className="text-white block mb-2">
                      Sensibilidade: {config.sensibilidade}%
                    </label>
                    <input
                      type="range"
                      min="0"
                      max="100"
                      value={config.sensibilidade}
                      onChange={(e) => handleSlider('sensibilidade', e.target.value)}
                      className="w-full h-2 bg-gray-700 rounded-lg appearance-none cursor-pointer accent-red-600"
                    />
                  </div>

                  <div>
                    <label className="text-white block mb-2">
                      Calibração Horizontal (X): {config.calibracaoX}
                    </label>
                    <input
                      type="range"
                      min="-50"
                      max="50"
                      value={config.calibracaoX}
                      onChange={(e) => handleSlider('calibracaoX', e.target.value)}
                      className="w-full h-2 bg-gray-700 rounded-lg appearance-none cursor-pointer accent-red-600"
                    />
                  </div>

                  <div>
                    <label className="text-white block mb-2">
                      Calibração Vertical (Y): {config.calibracaoY}
                    </label>
                    <input
                      type="range"
                      min="-50"
                      max="50"
                      value={config.calibracaoY}
                      onChange={(e) => handleSlider('calibracaoY', e.target.value)}
                      className="w-full h-2 bg-gray-700 rounded-lg appearance-none cursor-pointer accent-red-600"
                    />
                  </div>

                  <div>
                    <label className="text-white block mb-2">
                      Velocidade da Mira: {config.velocidadeMira}%
                    </label>
                    <input
                      type="range"
                      min="0"
                      max="100"
                      value={config.velocidadeMira}
                      onChange={(e) => handleSlider('velocidadeMira', e.target.value)}
                      className="w-full h-2 bg-gray-700 rounded-lg appearance-none cursor-pointer accent-red-600"
                    />
                  </div>
                </div>
              </div>

              <button
                onClick={resetarCalibacao}
                className="w-full bg-gray-700 hover:bg-gray-600 text-white font-bold py-3 rounded-lg transition-all"
              >
                Resetar Calibração
              </button>

              <button
                onClick={aplicarConfiguracoes}
                disabled={loading}
                className="w-full bg-gradient-to-r from-red-600 to-red-700 hover:from-red-700 hover:to-red-800 text-white font-bold py-4 rounded-lg transition-all transform hover:scale-105 disabled:opacity-50 shadow-lg"
              >
                {loading ? 'Salvando...' : 'Salvar Calibração'}
              </button>
            </>
          )}

          {activeTab === 'info' && (
            <div className="text-white space-y-4">
              <div className="bg-red-900/20 p-4 rounded-lg border border-red-600">
                <h3 className="text-xl font-bold mb-2 text-red-400">Informações</h3>
                <div className="space-y-2 text-sm">
                  <p><span className="text-red-400">Versão:</span> 1.94.8</p>
                  <p><span className="text-red-400">Package:</span> com.dts.freefireth</p>
                  <p><span className="text-red-400">API:</span> Netlify Functions</p>
                  <p><span className="text-red-400">Status:</span> Online</p>
                </div>
              </div>

              <div className="bg-red-900/20 p-4 rounded-lg border border-red-600">
                <h3 className="text-xl font-bold mb-2 text-red-400">Como Usar</h3>
                <ul className="space-y-2 text-sm list-disc list-inside">
                  <li>Ative as funções desejadas</li>
                  <li>Ajuste a precisão e sensibilidade</li>
                  <li>Calibre a mira na aba "Calibração"</li>
                  <li>Clique em "Aplicar Configurações"</li>
                  <li>Abra o Free Fire e divirta-se!</li>
                </ul>
              </div>


            </div>
          )}

          {status && (
            <div className={`text-center p-3 rounded-lg font-semibold ${
              status.includes('✓') 
                ? 'bg-green-900/40 text-green-400 border border-green-600' 
                : status.includes('✗')
                ? 'bg-red-900/40 text-red-400 border border-red-600'
                : 'bg-blue-900/40 text-blue-400 border border-blue-600'
            }`}>
              {status}
            </div>
          )}
        </div>
      </div>
    </div>
  );
}
